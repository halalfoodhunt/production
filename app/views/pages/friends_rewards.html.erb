<%= render 'layouts/category_header' %>
<div style="padding:60px 0 60px 0" class="container-fluid friends-rewards">
  <div class="col-xs-12 col-sm-6 col-md-6">
    <h3 style="color:#fff; font-weight:800; font-size:2.5em; text-transform:none; line-height:1; padding-left:15px;">Friends Rewards:<br>We reward you for choosing Halal!</h3>
    <%= render 'friends_search' %>
  </div>
  <div class="col-xs-12 col-sm-6 col-md-6"></div>
</div>
<div class="container">
  <div class="col-md-12">
   <div class="row">
    <div class="col-md-11" style="padding-top:40px"><h5 style="padding:20px 0">SHOWING <b><%= @places.distinct.count(:friends_rewards_terms) %></b> FRIENDS REWARDS IN ALL CITIES, SINGAPORE</h5></div>
    <div class="col-md-1" style="padding-top:40px"></div>
  </div>
</div>
<div class="container">
  <div class="row">
    <% @places.each do |place| %>
    <% unless place.friends_rewards_terms.blank? %>
    <div class="col-xs-12 col-sm-6 col-md-3" >
      <!--Rotating card-->
      <div class="card-wrapper">
        <div id="card-1" class="card-rotating effect__click">
          <!--Front Side-->
          <div class="face front">
            <!-- Image-->
            <div class="card-up">
              <%= image_tag place.featured_image.url(:square), :class => "img-responsive" %>
            </div>
            <!--Avatar-->
            <div class="avatar"><%= image_tag place.friends_reward.icon.url(:large), :class => "img-circle img_responsive" %>
            </div>
            <!--Content-->
            <div class="card-block" style="padding:0 5px 0 5px;">
              <h5 style="margin:0;"><%= link_to place_path(place) do %><strong><%= place.business_name %></strong><% end %></h5>
              <p style="margin:0;"><i class="fa fa-map-marker"></i> <%= place.operating_address %></p><br>
              <!--Triggering button-->
              <p><a class="rotate-btn btn btn-primary btn-sm" data-card="card-1"> <i class="fa fa-repeat"></i> Read terms here.</a></p>
            </div>
          </div>
          <!--/.Front Side-->
          <!--Back Side-->
          <div class="face back">
            <!--Content-->
            <h4><%= place.friends_reward.name %></h4>
            <hr>
            <p><%= place.friends_rewards_terms %></p>
            <hr>
            <!--Triggering button-->
            <a class="rotate-btn btn btn-primary btn-sm" data-card="card-1"><i class="fa fa-undo"></i> Click here to rotate back</a>
          </div>
          <!--/.Back Side-->
        </div>
      </div>
      <!--/.Rotating card-->
    </div>
    <% end %>
    <% end %>
    <% @ecommers.each do |ecommer| %>
    <% unless ecommer.friends_rewards_terms.blank? %>
    <div class="col-xs-12 col-sm-6 col-md-3" >
      <!--Rotating card-->
      <div class="card-wrapper">
        <div id="card-1" class="card-rotating effect__click">
          <!--Front Side-->
          <div class="face front">
            <!-- Image-->
            <div class="card-up">
              <%= image_tag ecommer.featured_image.url(:square), :class => "img-responsive" %>
            </div>
            <!--Avatar-->
            <div class="avatar"><%= image_tag ecommer.friends_reward.icon.url(:large), :class => "img-circle img_responsive" %>
            </div>
            <!--Content-->
            <div class="card-block" style="padding:0 5px 0 5px;">
              <h5 style="margin:0;"><%= link_to ecommer_path(ecommer) do %><strong><%= ecommer.business_name %></strong><% end %></h5>
              <p style="margin:0;"><i class="fa fa-map-marker"></i> <%= ecommer.operating_address %></p><br>
              <!--Triggering button-->
              <p><a class="rotate-btn btn btn-primary btn-sm" data-card="card-1"> <i class="fa fa-repeat"></i> Read terms here.</a></p>
            </div>
          </div>
          <!--/.Front Side-->
          <!--Back Side-->
          <div class="face back">
            <!--Content-->
            <h4><%= ecommer.friends_reward.name %></h4>
            <hr>
            <p><%= ecommer.friends_rewards_terms %></p>
            <hr>
            <!--Triggering button-->
            <a class="rotate-btn btn btn-primary btn-sm" data-card="card-1"><i class="fa fa-undo"></i> Click here to rotate back</a>
          </div>
          <!--/.Back Side-->
        </div>
      </div>
      <!--/.Rotating card-->
    </div>
    <% end %>
    <% end %>
  </div>
</div>
<script>
$('.rotate-btn').on('click', function(){
  $(this).closest('.card-rotating.effect__click').toggleClass('flipped');
});
</script>